{"ast":null,"code":"import _regeneratorRuntime from\"/Users/denizyuksel/Desktop/prosmarttravel/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/denizyuksel/Desktop/prosmarttravel/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/Users/denizyuksel/Desktop/prosmarttravel/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/denizyuksel/Desktop/prosmarttravel/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/denizyuksel/Desktop/prosmarttravel/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useContext}from\"react\";import\"./booking.css\";import{Form,FormGroup,ListGroup,ListGroupItem,Button}from\"reactstrap\";import{useNavigate}from\"react-router-dom\";import{AuthContext}from\"../../context/AuthContext\";import{BASE_URL}from\"../../utils/config\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Booking=function Booking(_ref){var tour=_ref.tour,avgRating=_ref.avgRating;var price=tour.price,reviews=tour.reviews,title=tour.title;var navigate=useNavigate();var _useContext=useContext(AuthContext),user=_useContext.user;var _useState=useState({userId:user?user._id:null,userEmail:user?user.email:\"\",tourName:title,fullName:\"\",phone:\"\",guestSize:1,bookAt:\"\"}),_useState2=_slicedToArray(_useState,2),booking=_useState2[0],setBooking=_useState2[1];var handleChange=function handleChange(e){setBooking(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},e.target.id,e.target.value));});};var TotalAmount=Number(price)*Number(booking.guestSize);var handleClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var res,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();console.log(booking);_context.prev=2;_context.next=5;return fetch(\"\".concat(BASE_URL,\"/booking\"),{method:\"post\",headers:{\"content-type\":\"application/json\"},credentials:\"include\",body:JSON.stringify(booking)});case 5:res=_context.sent;_context.next=8;return res.json();case 8:result=_context.sent;if(res.ok){_context.next=11;break;}return _context.abrupt(\"return\",alert(result.message));case 11:navigate(\"/thank-you\");_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](2);alert(_context.t0.message);case 17:case\"end\":return _context.stop();}},_callee,null,[[2,14]]);}));return function handleClick(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"booking\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"booking__top d-flex align-items-center justify-content-between\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"$\",price,\" \",/*#__PURE__*/_jsx(\"span\",{children:\"/per person\"})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"tour__rating d-flex align-items-center gap-1 \",children:[/*#__PURE__*/_jsx(\"i\",{class:\"ri-star-fill\"}),avgRating===0?null:avgRating,\"(\",reviews===null||reviews===void 0?void 0:reviews.length,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking__form\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Information\"}),/*#__PURE__*/_jsxs(Form,{className:\"booking__info-form\",onSubmit:handleClick,children:[/*#__PURE__*/_jsx(FormGroup,{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Full Name\",id:\"fullName\",required:true,onChange:handleChange})}),!user&&/*#__PURE__*/_jsx(FormGroup,{children:/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"userEmail\",placeholder:\"Enter your email\",value:booking.userEmail,onChange:handleChange,required:true})}),/*#__PURE__*/_jsx(FormGroup,{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Phone\",id:\"phone\",required:true,onChange:handleChange})}),/*#__PURE__*/_jsxs(FormGroup,{className:\"d-flex align-items-center gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"\",id:\"bookAt\",required:true,onChange:handleChange}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Guest\",id:\"guestSize\",required:true,onChange:handleChange})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"booking__bottom\",children:/*#__PURE__*/_jsxs(ListGroup,{children:[/*#__PURE__*/_jsxs(ListGroupItem,{className:\"border-0 px-0\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"d-flex align-items-center gap-1\",children:[\"$\",price,\" \",/*#__PURE__*/_jsx(\"i\",{class:\"ri-close-line\"}),\"1 person\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",price]})]}),/*#__PURE__*/_jsxs(ListGroupItem,{className:\"border-0 px-0 total\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Total\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",TotalAmount]})]}),/*#__PURE__*/_jsx(Button,{className:\"btn primary__btn w-100 mt-4\",onClick:handleClick,children:\"Book Now\"})]})})]});};export default Booking;","map":{"version":3,"names":["React","useState","useContext","Form","FormGroup","ListGroup","ListGroupItem","Button","useNavigate","AuthContext","BASE_URL","Booking","tour","avgRating","price","reviews","title","navigate","user","userId","_id","userEmail","email","tourName","fullName","phone","guestSize","bookAt","booking","setBooking","handleChange","e","prev","target","id","value","TotalAmount","Number","handleClick","preventDefault","console","log","fetch","method","headers","credentials","body","JSON","stringify","res","json","result","ok","alert","message","length"],"sources":["/Users/denizyuksel/Desktop/prosmarttravel/frontend/src/components/Booking/Booking.jsx"],"sourcesContent":["import React,{useState,useContext} from \"react\";\nimport \"./booking.css\";\nimport { Form, FormGroup, ListGroup, ListGroupItem, Button } from \"reactstrap\";\nimport { useNavigate } from \"react-router-dom\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport { BASE_URL } from \"../../utils/config\";\n\nconst Booking = ({ tour, avgRating }) => {\n  const { price, reviews ,title} = tour;\n  const navigate=useNavigate();\n\n  const { user } = useContext(AuthContext);\n\n  const [booking, setBooking] = useState({\nuserId: user ? user._id : null,\nuserEmail: user ? user.email : \"\",\ntourName: title,\nfullName: \"\",\nphone: \"\",\nguestSize: 1,\nbookAt:\"\"\n  });\n  const handleChange = e => {\n    setBooking(prev=>({...prev,[e.target.id]:e.target.value})\n    );\n  };\n  const TotalAmount=Number(price)*Number(booking.guestSize);\n\n  const handleClick = async e => {\n    e.preventDefault();\n    console.log(booking);\n    try {\n        const res=await fetch(`${BASE_URL}/booking`,{\n            method:\"post\",\n            headers:{\"content-type\":\"application/json\"},\n            credentials:\"include\",\n            body:JSON.stringify(booking)\n        });\n        const result=await res.json();\n        if(!res.ok) {\n          return alert(result.message);\n        }\n        navigate(\"/thank-you\");\n\n\n    } catch (error) {\n      alert(error.message);\n      \n    }\n};\n\n  return (\n    <div className=\"booking\">\n      <div className=\"booking__top d-flex align-items-center justify-content-between\">\n        <h3>\n          ${price} <span>/per person</span>\n        </h3>\n        <span className=\"tour__rating d-flex align-items-center gap-1 \">\n          <i class=\"ri-star-fill\"></i>\n          {avgRating === 0 ? null : avgRating}({reviews?.length})\n        </span>\n      </div>\n\n      {/*==================== Booking Form ====================*/}\n      <div className=\"booking__form\">\n        <h5>Information</h5>\n        <Form className=\"booking__info-form\" onSubmit={handleClick}>\n          <FormGroup>\n            <input\n              type=\"text\"\n              placeholder=\"Full Name\"\n              id=\"fullName\"\n              required\n              onChange={handleChange}\n            />\n          </FormGroup>\n\n          { !user && (\n            <FormGroup>\n            <input\n                type=\"email\"\n                id=\"userEmail\" \n                placeholder=\"Enter your email\"\n                value={booking.userEmail}  \n                onChange={handleChange}\n                required\n              />\n            </FormGroup>\n          )}\n          <FormGroup>\n            <input\n              type=\"text\"\n              placeholder=\"Phone\"\n              id=\"phone\"\n              required\n              onChange={handleChange}\n            />\n          </FormGroup>\n          <FormGroup className=\"d-flex align-items-center gap-3\">\n            <input\n              type=\"date\"\n              placeholder=\"\"\n              id=\"bookAt\"\n              required\n              onChange={handleChange}\n            />\n            <input\n              type=\"number\"\n              placeholder=\"Guest\"\n              id=\"guestSize\"\n              required\n              onChange={handleChange}\n            />\n          </FormGroup>\n        </Form>\n      </div>\n      {/*==================== Booking End ====================*/}\n\n        {/*==================== Booking bottom ====================*/}\n        <div className=\"booking__bottom\">\n            <ListGroup>\n                <ListGroupItem className=\"border-0 px-0\">\n                <h5 className=\"d-flex align-items-center gap-1\">${price} <i class='ri-close-line'></i>1 person</h5>\n                <span>${price}</span>\n                </ListGroupItem>\n                <ListGroupItem className=\"border-0 px-0 total\">\n                <h5>Total</h5>\n                <span>${TotalAmount}</span>\n                </ListGroupItem>\n                <Button className=\"btn primary__btn w-100 mt-4\" onClick={handleClick}>Book Now</Button>\n            </ListGroup>\n        </div>\n    </div>\n  );\n};\n\nexport default Booking;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}